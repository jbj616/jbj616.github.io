---
title: "[Spring-study] QnA 2단계 - DB에 데이터 저장"
excerpt: "2019. 08. 15. Spring"
search: true
categories:
  - spring_study
tags:


---

## QnA 2단계 - DB에 데이터 저장

> 공부한 거



### 프레임워크 와 라이브러리의 차이

- 프레임 워크는 일반 적으로 **틀** 이라고 말할 수 있다. 프로젝트 또는 애플리케이션을 작업을 할 때 더욱 편리하게 작업을 할 수 있는 환경을 제공 해주며 효율적인 개발을 위한 기본적인 뼈대라 말 할수있다. 반면에 라이브러리는 반복적으로 사용하는 코드를 미리 구현 해 놓고 가져다가 쓰는 도구로써의 기능을 한다고 말 할 수 있다.

### H2 콘솔 접속

- 접속 주소 : http://localhost:8080/h2-console



### 데이터베이스 설정

#### 의존관계 설정 - gradle

```
compile('org.springframework.boot:spring-boot-starter-data-jpa')
runtime('com.h2database:h2')
```

#### 의존관계 설정 - maven

- pom.xml 파일에 다음 라이브러리에 대한 의존관계를 설정한다.

```
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-data-jpa</artifactId>
</dependency>
<dependency>
    <groupId>com.h2database</groupId>
    <artifactId>h2</artifactId>
    <version>1.4.192</version>
</dependency>
```

------

#### DB Connection 설정 – application.properties

```
spring.datasource.url=jdbc:h2:~/my-jwp;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
spring.datasource.driverClassName=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=

spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
```

------

#### 실행 쿼리 보기 설정 – application.properties

```
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
```

------

#### 테이블 자동 생성 설정 – application.properties

- 서버를 시작하는 시점에 DB 테이블을 drop후에 다시 생성하도록 설정하는 방법.

```
spring.jpa.hibernate.ddl-auto=create-drop
```

- 서버를 시작하는 시점에 DB 테이블을 drop하지 않도록 설정하는 방법.

```
spring.jpa.hibernate.ddl-auto=validate
```



### DB에 저장할 User 클래스

- User 클래스를 @Entity로 설정한다.

- User 클래스에 대한 유일한 key 값을 @Id로 매핑한다. (primary key)

- @Id에 @GeneratedValue 애노테이션을 추가하면 key가 자동으로 증가한다.

  ```java
  @Id
  @GeneratedValue(strategy = GenerationType.IDENTITY)
  private Long id;
  ```

- 각 필드를 테이블 칼럼과 매핑할 때는 @Column 애노테이션을 사용한다.



**Repository 생성시**

```
public interface UserRepository extends JpaRepository<User, Long> {

}
```

- `<User, Long> ` => 객체, Id 타입



### h2 사용

- finallAll(), findById()로 데이터 찾기





> 궁금 증

### JpaRepository 와 CrudRepository 의 차이점

- JpaRepository 는 PagingAndSortingRepository 와 CrudRepository 확장
-  PagingAndSortingRepository 와 CrudRepository 기능
  - CrudRepository = CRUD 기능 제공
  - PagingAndSortingRepository = 페이지 매김 및 정렬 레코드를 수행하는 메소드를 제공

- JpaRepository = 페이지 매김 및 정렬 레코드를 수행하는 메소드를 제공

위에서 언급 한 상속 때문에 JpaRepository는 CrudRepository 및 PagingAndSortingRepository의 모든 기능을 갖습니다. 따라서 JpaRepository와 PagingAndSortingRepository가 제공하는 기능을 저장소에 필요로하지 않는다면 CrudRepository를 사용